<%= render 'shared/map_navbar' %>

<%# Mapbox map display %>
<div style="width: 100vw; height: 100vh; position: relative;">
  <%# controls %>
  <div style="position: absolute; top: 0px; left: 0px; padding: 10px; z-index: 1; width: 100%;">
    <%= form_tag loos_path, method: :get, class: "my-1" do %>
      <div class="d-flex">
        <%= text_field_tag :query,
          params[:query],
          class: "form-control",
          placeholder: "Find a loo"
        %>
        <%= submit_tag "Search", class: "btn btn-primary ms-1" %>
      </div>
    <% end %>
    <ul class="nav nav-pills my-3 d-flex justify-content-center" id="pills-tab" role="tablist">
      <li class="nav-item me-1" role="presentation">
        <button class="btn-2 btn-secondary btn-sm active fs-5 text" id="pills-mapview-tab" data-bs-toggle="pill" data-bs-target="#pills-mapview" type="button" role="tab" aria-controls="pills-mapview" aria-selected="false">Map view</button>
      </li>
      <li class="nav-item me-1" role="presentation">
        <button class="btn-2 btn-secondary btn-sm fs-5 text" id="pills-listview-tab" data-bs-toggle="pill" data-bs-target="#pills-listview" type="button" role="tab" aria-controls="pills-listview" aria-selected="false">List view</button>
      </li>
    </ul>
  </div>

  <%# content %>
  <div class="tab-content" id="pills-tabContent" style="height: 100%">
    <div class="tab-pane fade show active" id="pills-mapview" role="tabpanel" aria-labelledby="pills-mapview-tab" style="height: 100%">
      <div style="width: 100%; height: 100%;"
        data-controller="mapbox"
        data-mapbox-markers-value="<%= @markers.to_json %>"
        data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
      <%# map overlay at the bottom of page %>
      <div style="position: absolute; bottom: 0px; padding: 10px;">
       <%= link_to "TotheLOO!!", loos_path, class: "btn btn-primary" %>
       </div>
    </div>


    <div class="tab-pane fade" id="pills-listview" role="tabpanel" aria-labelledby="pills-listview-tab"> //styling
      <div class="container-index-list">
        <% @loos.each do |loo| %>
          <div class="border border-primary mb-2">
            <p>
              <strong>Name:</strong>
              <%= loo.name %>
            </p>
            <p>
              <strong>Facility Type:</strong>
              <%= loo.facility_type %>
            </p>
            <p>
              <strong>Address:</strong>
              <%= loo.address %>
            </p>

            <%= link_to 'Learn more', loo_path(loo), class: "btn btn-primary" %>

          </div>
        <% end %>
      </div>
    </div>


  </div>
</div>
